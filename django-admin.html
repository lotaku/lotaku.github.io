<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Django-Admin - myblog</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

    <!-- Open Graph tags -->
        <meta property="og:site_name" content="myblog" />
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Django-Admin"/>
            <meta property="og:url" content="/django-admin.html"/>
            <meta property="og:description" content="其他语言 仅需添加django.middleware.locale.LocaleMiddleware 到MIDDLEWARE_CLASSES 设置中，并确保它在django.contrib.sessions.middleware.SessionMiddleware 之后 自定义字段标签 将Author.email的标签改为e-mail，中间有个横线。 class Author(models.Model): first_name = models.CharField(max_length=30) last_name = models.CharField(max_length=40) email = models.EmailField(blank=True, verbose_name=&#39;e-mail&#39; ) 简洁语法,你可以把它当作固定位置的参数传递。 这个例子与上面那个的效果相同。 class Author(models.Model): first_name ..."/>
            <meta property="article:published_time" content="2014-05-28" />
                <meta property="article:section" content="misc" />
                <meta property="article:tag" content="django" />
                <meta property="article:author" content="lotaku" />

    <!-- Bootstrap -->
        <link rel="stylesheet" href="/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="/theme/css/style.css" type="text/css"/>


</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="/" class="navbar-brand">
myblog            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="/pages/guan-yu-wo.html">
                             关于我
                          </a></li>
                        <li class="active">
                            <a href="/category/misc.html">Misc</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="/django-admin.html"
                       rel="bookmark"
                       title="Permalink to Django-Admin">
                        Django-Admin
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2014-05-28T00:00:00"> 三 28 五月 2014</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="/tag/django.html">django</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h3>其他语言</h3>
<p>仅需添加<code>django.middleware.locale.LocaleMiddleware</code> 到<code>MIDDLEWARE_CLASSES</code> 设置中，并确保它在<code>django.contrib.sessions.middleware.SessionMiddleware</code> 之后</p>
<h3>自定义字段标签</h3>
<p>将Author.email的标签改为e-mail，中间有个横线。</p>
<div class="highlight"><pre><span class="n">class</span> <span class="n">Author</span><span class="p">(</span><span class="n">models</span><span class="p">.</span><span class="n">Model</span><span class="p">)</span><span class="o">:</span>
    <span class="n">first_name</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">last_name</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">EmailField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="n">True</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="err">&#39;</span><span class="n">e</span><span class="o">-</span><span class="n">mail</span><span class="err">&#39;</span> <span class="p">)</span>
</pre></div>


<p>简洁语法,你可以把它当作固定位置的参数传递。 这个例子与上面那个的效果相同。</p>
<p>class Author(models.Model):
    first_name = models.CharField(max_length=30)
    last_name = models.CharField(max_length=40)
    email = models.EmailField('e-mail',  blank=True)</p>
<p>但这不适用于ManyToManyField 和ForeignKey字段，因为它们第一个参数必须是模块类。 那种情形，必须显式使用verbose_name这个参数名称。</p>
<h3>自定义列表</h3>
<p>比如说：在这个列表中可以看到作者的邮箱地址。如果能按照姓氏或名字来排序，那就更好了。</p>
<p>为了达到这个目的，我们将为Author模块定义一个ModelAdmin类。 这个类是自定义管理工具的关键，其中最基本的一件事情是允许你指定列表中的字段。 打开admin.py并修改：</p>
<div class="highlight"><pre><span class="n">from</span> <span class="n">django</span><span class="p">.</span><span class="n">contrib</span> <span class="n">import</span> <span class="n">admin</span>
<span class="n">from</span> <span class="n">mysite</span><span class="p">.</span><span class="n">books</span><span class="p">.</span><span class="n">models</span> <span class="n">import</span> <span class="n">Publisher</span><span class="p">,</span> <span class="n">Author</span><span class="p">,</span> <span class="n">Book</span>

<span class="n">class</span> <span class="n">AuthorAdmin</span><span class="p">(</span><span class="n">admin</span><span class="p">.</span><span class="n">ModelAdmin</span><span class="p">)</span><span class="o">:</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">first_name</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">last_name</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">email</span><span class="err">&#39;</span><span class="p">)</span>

<span class="n">admin</span><span class="p">.</span><span class="n">site</span><span class="p">.</span><span class="k">register</span><span class="p">(</span><span class="n">Publisher</span><span class="p">)</span>
<span class="n">admin</span><span class="p">.</span><span class="n">site</span><span class="p">.</span><span class="k">register</span><span class="p">(</span><span class="n">Author</span><span class="p">,</span> <span class="n">AuthorAdmin</span><span class="p">)</span>
<span class="n">admin</span><span class="p">.</span><span class="n">site</span><span class="p">.</span><span class="k">register</span><span class="p">(</span><span class="n">Book</span><span class="p">)</span>
</pre></div>


<p>解释一下代码：</p>
<p>我们新建了一个类AuthorAdmin，它是从django.contrib.admin.ModelAdmin派生出来的子类，保存着一个类的自定义配置，以供管理工具使用。 我们只自定义了一项：list_display， 它是一个字段名称的元组，用于列表显示。 当然，这些字段名称必须是模块中有的。3</p>
<p>我们修改了admin.site.register()调用，在Author后面添加了AuthorAdmin。你可以这样理解： 用AuthorAdmin选项注册Author模块。</p>
<p>admin.site.register()函数接受一个ModelAdmin子类作为第二个参数。 如果你忽略第二个参数，Django将使用默认的选项。Publisher和Book的注册就属于这种情况。</p>
<h3>添加一个快速查询栏。</h3>
<p>向AuthorAdmin追加search_fields，如：</p>
<div class="highlight"><pre><span class="n">class</span> <span class="n">AuthorAdmin</span><span class="p">(</span><span class="n">admin</span><span class="p">.</span><span class="n">ModelAdmin</span><span class="p">)</span><span class="o">:</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">first_name</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">last_name</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">email</span><span class="err">&#39;</span><span class="p">)</span>
    <span class="n">search_fields</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">first_name</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">last_name</span><span class="err">&#39;</span><span class="p">)</span>
</pre></div>


<p>刷新浏览器，你会在页面顶端看到一个查询栏。 （见图6-9.）我们刚才所作的修改列表页面，添加了一个根据姓名查询的查询框。 正如用户所希望的那样，它是大小写敏感，并且对两个字段检索的查询框。如果查询"bar"，那么名字中含有Barney和姓氏中含有Hobarson的作者记录将被检索出来。</p>
<h3>添加一些过滤器</h3>
<div class="highlight"><pre><span class="n">class</span> <span class="n">BookAdmin</span><span class="p">(</span><span class="n">admin</span><span class="p">.</span><span class="n">ModelAdmin</span><span class="p">)</span><span class="o">:</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">title</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">publisher</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">publication_date</span><span class="err">&#39;</span><span class="p">)</span>
    <span class="n">list_filter</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">publication_date</span><span class="err">&#39;</span><span class="p">,)</span>
    <span class="n">date_hierarchy</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">publication_date</span>
</pre></div>


<h3>改变默认的排序方式</h3>
<div class="highlight"><pre><span class="n">ordering</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="o">-</span><span class="n">publication_date</span><span class="err">&#39;</span><span class="p">,)</span>
</pre></div>


<h3>自定义编辑表单</h3>
<p>首先，我们先自定义字段顺序。 默认地，表单中的字段顺序是与模块中定义是一致的。 我们可以通过使用ModelAdmin子类中的fields选项来改变它：</p>
<div class="highlight"><pre><span class="n">class</span> <span class="n">BookAdmin</span><span class="p">(</span><span class="n">admin</span><span class="p">.</span><span class="n">ModelAdmin</span><span class="p">)</span><span class="o">:</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">title</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">publisher</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">publication_date</span><span class="err">&#39;</span><span class="p">)</span>
    <span class="n">list_filter</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">publication_date</span><span class="err">&#39;</span><span class="p">,)</span>
    <span class="n">date_hierarchy</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">publication_date</span><span class="err">&#39;</span>
    <span class="n">ordering</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="o">-</span><span class="n">publication_date</span><span class="err">&#39;</span><span class="p">,)</span>
    <span class="o">**</span><span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">title</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">authors</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">publisher</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">publication_date</span><span class="err">&#39;</span><span class="p">)</span><span class="o">**</span>
</pre></div>


<p>通过fields这个选项，你可以排除一些不想被其他人编辑的fields 只要不选上不想被编辑的field(s)即可。 当你的admi用户只是被信任可以更改你的某一部分数据时，或者，你的数据被一些外部的程序自动处理而改变了了，你就可以用这个功能。 例如，在book数据库中，我们可以隐藏publication_date，以防止它被编辑。</p>
<h3>针对多选字段</h3>
<p>使用filter_horizontal 或者 filter_vertical 。让我们把它添加到BookAdmin中，然后看看它的效果。</p>
<div class="highlight"><pre><span class="n">class</span> <span class="n">BookAdmin</span><span class="p">(</span><span class="n">admin</span><span class="p">.</span><span class="n">ModelAdmin</span><span class="p">)</span><span class="o">:</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">title</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">publisher</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">publication_date</span><span class="err">&#39;</span><span class="p">)</span>
    <span class="n">list_filter</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">publication_date</span><span class="err">&#39;</span><span class="p">,)</span>
    <span class="n">date_hierarchy</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">publication_date</span><span class="err">&#39;</span>
    <span class="n">ordering</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="o">-</span><span class="n">publication_date</span><span class="err">&#39;</span><span class="p">,)</span>
    <span class="o">**</span><span class="n">filter_horizontal</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">authors</span><span class="err">&#39;</span><span class="p">,)</span><span class="o">**</span>
</pre></div>


<p>刷新book编辑页面，你会看到Author区中有一个精巧的JavaScript过滤器，它允许你检索选项，然后将选中的authors从Available框移到Chosen框，还可以移回来。</p>
<h3>装载过多的选项，为减少消耗，使用：</h3>
<p><code>raw_id_fields</code></p>
<div class="highlight"><pre><span class="n">class</span> <span class="n">BookAdmin</span><span class="p">(</span><span class="n">admin</span><span class="p">.</span><span class="n">ModelAdmin</span><span class="p">)</span><span class="o">:</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">title</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">publisher</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">publication_date</span><span class="err">&#39;</span><span class="p">)</span>
    <span class="n">list_filter</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">publication_date</span><span class="err">&#39;</span><span class="p">,)</span>
    <span class="n">date_hierarchy</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">publication_date</span><span class="err">&#39;</span>
    <span class="n">ordering</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="o">-</span><span class="n">publication_date</span><span class="err">&#39;</span><span class="p">,)</span>
    <span class="n">filter_horizontal</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">authors</span><span class="err">&#39;</span><span class="p">,)</span>
    <span class="o">**</span><span class="n">raw_id_fields</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">publisher</span><span class="err">&#39;</span><span class="p">,)</span><span class="o">**</span>
</pre></div>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = '{lotaku}'; // required: replace example with your forum shortname

                    var disqus_identifier = 'django-admin';
                var disqus_url = '/django-admin.html';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
                  <ul class="list-group" id="social">
                    <li class="list-group-item"><a href="#"><i class="fa fa-you can add links in your config file-square fa-lg"></i> You can add links in your config file</a></li>
                    <li class="list-group-item"><a href="#"><i class="fa fa-another social link-square fa-lg"></i> Another social link</a></li>
                  </ul>
                </li>



                <li class="list-group-item"><a href="/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                    <ul class="list-group " id="tags">
                        <li class="list-group-item tag-0">
                            <a href="/tag/django.html">
                                django
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="/tag/xue-xi.html">
                                学习
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="/tag/linux.html">
                                linux
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="/tag/markdown.html">
                                markdown
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="/tag/pythonda-bao.html">
                                python打包
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="/tag/python.html">
                                python
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="/tag/xi-tong.html">
                                系统
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="/tag/mysql.html">
                                mysql
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="/tag/pelican.html">
                                pelican
                            </a>
                        </li>
                    </ul>
                </li>    
    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://getpelican.com/" target="_blank">
                Pelican
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://python.org/" target="_blank">
                Python.org
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://jinja.pocoo.org/" target="_blank">
                Jinja2
            </a>
        </li>
        <li class="list-group-item">
            <a href="#" target="_blank">
                You can modify those links in your config file
            </a>
        </li>
      </ul>
    </li>

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2014 lotaku
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = '{lotaku}'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
</body>
</html>